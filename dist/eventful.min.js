"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}var eventfulCollectionPropertyDescriptors={definedByEventfulCollectionPropertyDescriptors:{value:!0},eventfulCollectionData:{writable:!0},adjustEventfulCollection:{value:function(e){for(var t=this;e!==this.length;)e<this.length?function(){var r=String(e);Object.defineProperty(t,r,{configurable:!0,enumerable:!0,set:function(e){if(this.eventfulCollectionData[r]!==e){var t=this.eventfulCollectionData[r];this.eventfulCollectionData[r]=e,this.definedByEventfulEmitterPropertyDescriptors&&e!==t&&(this.trigger("change",r,e,t),this.trigger("change:".concat(r),e,t))}},get:function(){return this.eventfulCollectionData[r]}}),e++}():(delete this[String(e-1)],e--)}},length:{get:function(){return this.eventfulCollectionData?this.eventfulCollectionData.length:0}},toArray:{value:function(){if(!this.eventfulCollectionData)return[];var r=this.eventfulCollectionData.slice();return r.forEach(function(e,t){e.definedByEventfulDictionaryPropertyDescriptors?r[t]=e.toJSON():e.definedByEventfulCollectionPropertyDescriptors&&(r[t]=e.toArray())}),r}}};function eventfulCollection(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return Array.isArray(e)&&(t=e,e={}),(e=eventful(e)).definedByEventfulCollectionPropertyDescriptors||(e=Object.defineProperties(e,eventfulCollectionPropertyDescriptors)),e.push.apply(e,_toConsumableArray(t)),e}["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"].forEach(function(a){eventfulCollectionPropertyDescriptors[a]={value:function(){for(var e,t=this.length,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=(e=Array.prototype[a]).call.apply(e,[this.eventfulCollectionData].concat(n));return this.adjustEventfulCollection(t),this.definedByEventfulEmitterPropertyDescriptors&&this.trigger("change"),o}}}),["concat","includes","indexOf","join","lastIndexOf","slice","toSource","toString","toLocaleString","entries","every","filter","find","findIndex","forEach","keys","map","reduce","reduceRight","some","values"].forEach(function(i){eventfulCollectionPropertyDescriptors[i]={value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=Array.prototype[i]).call.apply(e,[this.eventfulCollectionData].concat(r))}}});var eventfulDictionaryPropertyDescriptors={definedByEventfulDictionaryPropertyDescriptors:{value:!0},eventfulDictionaryData:{writable:!0},observeProperty:{value:function(n,e,t){var r=1<arguments.length&&void 0!==e?e:this[n],i=2<arguments.length&&void 0!==t?t:{},o=i.setter,a=void 0===o?function(e,t){return t()}:o,l=i.getter,s=void 0===l?function(e){return e()}:l;this.eventfulDictionaryData||(this.eventfulDictionaryData={});var f=Object.getOwnPropertyDescriptor(this,n);return f&&(f.get||f.set)||(void 0!==r&&(this.eventfulDictionaryData[n]=r),delete this[n],Object.defineProperty(this,n,{configurable:!0,enumerable:!0,set:function(e){var t=this;if(this.eventfulDictionaryData[n]!==e){var r=this.eventfulDictionaryData[n];a.call(this,e,function(){t.eventfulDictionaryData[n]=e,t.definedByEventfulEmitterPropertyDescriptors&&e!==r&&(t.trigger("change",n,e,r),t.trigger("change:".concat(n),e,r))})}},get:function(){var e=this;return s.call(this,function(){return e.eventfulDictionaryData[n]})}})),this}},unobserveProperty:{value:function(e){if(this.eventfulDictionaryData)return this;var t=Object.getOwnPropertyDescriptor(this,e);if(t&&(t.get||t.set)){var r=this.eventfulDictionaryData[e];delete this.eventfulDictionaryData[e],delete this[e],void 0!==r&&(this[e]=r)}return this}},toJSON:{value:function(){var e=Object.assign({},this.eventfulDictionaryData);for(var t in e)e[t].definedByEventfulDictionaryPropertyDescriptors?e[t]=e[t].toJSON():e[t].definedByEventfulCollectionPropertyDescriptors&&(e[t]=e[t].toArray());return e}}};function eventfulDictionary(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(t=eventful(t)).definedByEventfulDictionaryPropertyDescriptors||(t=Object.defineProperties(t,eventfulDictionaryPropertyDescriptors)),Object.keys(t).forEach(function(e){t.observeProperty(e)}),t}var eventfulDomPropertyDescriptors={definedByEventfulDomPropertyDescriptors:{value:!0},eventfulDomData:{writable:!0},on:{value:function(n,i,o,a,e){var l=this,t=(4<arguments.length&&void 0!==e?e:{}).fromObserver,r=void 0!==t&&t;this.eventfulDomData||(this.eventfulDomData={});function s(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];i.call.apply(i,[l].concat(t)),o&&l.off(n,i,o,a)}return this.addEventListener(name,s),this.eventfulDomData.push({event:n,handler:i,once:o,observer:a,listener:s}),this.definedByEventfulEmitterPropertyDescriptors?eventfulEmitterPropertyDescriptors.on.value.call(this,n,i,o,a,{fromObserver:r}):this}},off:{value:function(e,t,r,n,i){var o=(4<arguments.length&&void 0!==i?i:{}).fromObserver,a=void 0!==o&&o;if(this.eventfulDomData)return this;for(var l=0;l<this.eventfulDomData.length;){var s=this.eventfulDomData[l],f=s.event,v=s.handler,u=s.once,c=s.observer,h=s.listener;e&&e!==f||t&&t!==v||null!=r&&r!==u||n&&n!==c?l++:(this.eventfulDomData.splice(l,1),this.removeEventListener(name,h))}return this.definedByEventfulEmitterPropertyDescriptors?eventfulEmitterPropertyDescriptors.off.value.call(this,e,t,r,n,{fromObserver:a}):this}}};function eventfulDom(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(e=eventful(e)).definedByEventfulDomPropertyDescriptors||(e=Object.defineProperties(e,eventfulDomPropertyDescriptors)),e}var eventfulEmitterPropertyDescriptors={definedByEventfulEmitterPropertyDescriptors:{value:!0},eventfulEmitterEnabled:{writable:!0,value:!0},eventfulEmitterData:{writable:!0},on:{value:function(e,t,r,n,i){var o=(4<arguments.length&&void 0!==i?i:{}).fromObserver,a=void 0!==o&&o;return this.eventfulEmitterData||(this.eventfulEmitterData=[]),this.eventfulEmitterData.push({event:e,handler:t,once:r,observer:n}),!a&&n&&n.listenTo(this,e,t,r,{fromEmitter:!0}),this}},off:{value:function(t,r,n,e,i){var o=this,a=(4<arguments.length&&void 0!==i?i:{}).fromObserver,l=void 0!==a&&a;if(!this.eventfulEmitterData)return this;for(var s=[],f=0;f<this.eventfulEmitterData.length;){var v=this.eventfulEmitterData[f],u=v.event,c=v.handler,h=v.once,p=v.observer;t&&t!==u||r&&r!==c||null!=n&&n!==h||e&&e!==p?f++:(this.eventfulEmitterData.splice(f,1),p&&-1===s.indexOf(p)&&s.push(p))}return l||s.forEach(function(e){e.stopListening(o,t,r,n,{fromEmitter:!0})}),this}},trigger:{value:function(o){for(var a=this,e=arguments.length,l=new Array(1<e?e-1:0),t=1;t<e;t++)l[t-1]=arguments[t];return this.eventfulEmitterData&&this.eventfulEmitterEnabled&&(this.eventfulEmitterData.forEach(function(e){var t=e.event,r=e.handler,n=e.observer;if(o===t){var i=n||a;r.call.apply(r,[i].concat(l))}}),this.off(o,null,!0)),this}}};function eventfulEmitter(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.definedByEventfulEmitterPropertyDescriptors||(e=Object.defineProperties(e,eventfulEmitterPropertyDescriptors)),e}function eventful(e){return eventfulObserver(eventfulEmitter(e))}var eventfulObserverPropertyDescriptors={definedByEventfulObserverPropertyDescriptors:{value:!0},eventfulObserverData:{writable:!0},listenTo:{value:function(e,t,r,n,i){var o=(4<arguments.length&&void 0!==i?i:{}).fromEmitter;return!(void 0!==o&&o)&&e&&e.on(t,r,n,this,{fromObserver:!0}),this.eventfulObserverData||(this.eventfulObserverData=[]),this.eventfulObserverData.push({emitter:e,event:t,handler:r,once:n}),this}},stopListening:{value:function(e,t,r,n,i){var o=this,a=(4<arguments.length&&void 0!==i?i:{}).fromEmitter,l=void 0!==a&&a;if(!this.eventfulObserverData)return this;for(var s=[],f=0;f<this.eventfulObserverData.length;){var v=this.eventfulObserverData[f],u=v.emitter,c=v.event,h=v.handler,p=v.once;e&&e!==u||t&&t!==c||r&&r!==h||null!=n&&n!==p?f++:(this.eventfulObserverData.splice(f,1),u&&-1===s.indexOf(u)&&s.push(u))}return l||s.forEach(function(e){e.off(t,r,n,o,{fromEmitter:!0})}),this}}};function eventfulObserver(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.definedByEventfulObserverPropertyDescriptors||(e=Object.defineProperties(e,eventfulObserverPropertyDescriptors)),e}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV2ZW50ZnVsLmpzIl0sIm5hbWVzIjpbIl90b0NvbnN1bWFibGVBcnJheSIsImFyciIsIl9hcnJheVdpdGhvdXRIb2xlcyIsIl9pdGVyYWJsZVRvQXJyYXkiLCJfbm9uSXRlcmFibGVTcHJlYWQiLCJUeXBlRXJyb3IiLCJpdGVyIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJPYmplY3QiLCJwcm90b3R5cGUiLCJ0b1N0cmluZyIsImNhbGwiLCJBcnJheSIsImZyb20iLCJpc0FycmF5IiwiaSIsImFycjIiLCJsZW5ndGgiLCJldmVudGZ1bENvbGxlY3Rpb25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lZEJ5RXZlbnRmdWxDb2xsZWN0aW9uUHJvcGVydHlEZXNjcmlwdG9ycyIsInZhbHVlIiwiZXZlbnRmdWxDb2xsZWN0aW9uRGF0YSIsIndyaXRhYmxlIiwiYWRqdXN0RXZlbnRmdWxDb2xsZWN0aW9uIiwic3RhcnRpbmdMZW5ndGgiLCJfdGhpcyIsInRoaXMiLCJrZXkiLCJTdHJpbmciLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJzZXQiLCJvbGRWYWx1ZSIsImRlZmluZWRCeUV2ZW50ZnVsRW1pdHRlclByb3BlcnR5RGVzY3JpcHRvcnMiLCJ0cmlnZ2VyIiwiY29uY2F0IiwiZ2V0IiwidG9BcnJheSIsImFycmF5Iiwic2xpY2UiLCJmb3JFYWNoIiwiaW5kZXgiLCJkZWZpbmVkQnlFdmVudGZ1bERpY3Rpb25hcnlQcm9wZXJ0eURlc2NyaXB0b3JzIiwidG9KU09OIiwiZXZlbnRmdWxDb2xsZWN0aW9uIiwib2JqIiwiYXJndW1lbnRzIiwidW5kZWZpbmVkIiwiZXZlbnRmdWwiLCJkZWZpbmVQcm9wZXJ0aWVzIiwicHVzaCIsImFwcGx5IiwibWV0aG9kIiwiX0FycmF5JHByb3RvdHlwZSRtZXRoIiwiX2xlbiIsImFyZ3MiLCJfa2V5IiwicmV0dXJuVmFsdWUiLCJfQXJyYXkkcHJvdG90eXBlJG1ldGgyIiwiX2xlbjIiLCJfa2V5MiIsImV2ZW50ZnVsRGljdGlvbmFyeVByb3BlcnR5RGVzY3JpcHRvcnMiLCJldmVudGZ1bERpY3Rpb25hcnlEYXRhIiwib2JzZXJ2ZVByb3BlcnR5IiwibmFtZSIsIl92YWx1ZSIsIl9yZWYiLCJfcmVmJHNldHRlciIsInNldHRlciIsInNldHRlckNiayIsIl9yZWYkZ2V0dGVyIiwiZ2V0dGVyIiwiZ2V0dGVyQ2JrIiwicHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiX3RoaXMyIiwiX3RoaXMzIiwidW5vYnNlcnZlUHJvcGVydHkiLCJqc29uIiwiYXNzaWduIiwiZXZlbnRmdWxEaWN0aW9uYXJ5Iiwia2V5cyIsInByb3BlcnR5IiwiZXZlbnRmdWxEb21Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lZEJ5RXZlbnRmdWxEb21Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZXZlbnRmdWxEb21EYXRhIiwib24iLCJldmVudCIsImhhbmRsZXIiLCJvbmNlIiwib2JzZXJ2ZXIiLCJfdGhpczQiLCJfcmVmMiRmcm9tT2JzZXJ2ZXIiLCJmcm9tT2JzZXJ2ZXIiLCJsaXN0ZW5lciIsIl9sZW4zIiwiX2tleTMiLCJvZmYiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnRmdWxFbWl0dGVyUHJvcGVydHlEZXNjcmlwdG9ycyIsIl9yZWYzJGZyb21PYnNlcnZlciIsIl90aGlzJGV2ZW50ZnVsRG9tRGF0YSIsImRhdGFFdmVudCIsImRhdGFIYW5kbGVyIiwiZGF0YU9uY2UiLCJkYXRhT2JzZXJ2ZXIiLCJkYXRhTGlzdGVuZXIiLCJzcGxpY2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnRmdWxEb20iLCJldmVudGZ1bEVtaXR0ZXJFbmFibGVkIiwiZXZlbnRmdWxFbWl0dGVyRGF0YSIsIl9yZWY0JGZyb21PYnNlcnZlciIsImxpc3RlblRvIiwiZnJvbUVtaXR0ZXIiLCJfdGhpczUiLCJfcmVmNSRmcm9tT2JzZXJ2ZXIiLCJvYnNlcnZlcnMiLCJfdGhpcyRldmVudGZ1bEVtaXR0ZXIiLCJpbmRleE9mIiwic3RvcExpc3RlbmluZyIsIl90aGlzNiIsIl9sZW40IiwiX2tleTQiLCJfcmVmNiIsImNvbnRleHQiLCJldmVudGZ1bEVtaXR0ZXIiLCJldmVudGZ1bE9ic2VydmVyIiwiZXZlbnRmdWxPYnNlcnZlclByb3BlcnR5RGVzY3JpcHRvcnMiLCJkZWZpbmVkQnlFdmVudGZ1bE9ic2VydmVyUHJvcGVydHlEZXNjcmlwdG9ycyIsImV2ZW50ZnVsT2JzZXJ2ZXJEYXRhIiwiZW1pdHRlciIsIl9yZWY3JGZyb21FbWl0dGVyIiwiX3RoaXM3IiwiX3JlZjgkZnJvbUVtaXR0ZXIiLCJlbWl0dGVycyIsIl90aGlzJGV2ZW50ZnVsT2JzZXJ2ZSIsImRhdGFFbWl0dGVyIl0sIm1hcHBpbmdzIjoiQUFBQSxhQUVBLFNBQVNBLG1CQUFtQkMsR0FBTyxPQUFPQyxtQkFBbUJELElBQVFFLGlCQUFpQkYsSUFBUUcscUJBRTlGLFNBQVNBLHFCQUF1QixNQUFNLElBQUlDLFVBQVUsbURBRXBELFNBQVNGLGlCQUFpQkcsR0FBUSxHQUFJQyxPQUFPQyxZQUFZQyxPQUFPSCxJQUFrRCx1QkFBekNHLE9BQU9DLFVBQVVDLFNBQVNDLEtBQUtOLEdBQWdDLE9BQU9PLE1BQU1DLEtBQUtSLEdBRTFKLFNBQVNKLG1CQUFtQkQsR0FBTyxHQUFJWSxNQUFNRSxRQUFRZCxHQUFNLENBQUUsSUFBSyxJQUFJZSxFQUFJLEVBQUdDLEVBQU8sSUFBSUosTUFBTVosRUFBSWlCLFFBQVNGLEVBQUlmLEVBQUlpQixPQUFRRixJQUFPQyxFQUFLRCxHQUFLZixFQUFJZSxHQUFNLE9BQU9DLEdBRzdKLElBQUlFLHNDQUF3QyxDQUMxQ0MsK0NBQWdELENBQzlDQyxPQUFPLEdBRVRDLHVCQUF3QixDQUN0QkMsVUFBVSxHQUVaQyx5QkFBMEIsQ0FDeEJILE1BQU8sU0FBZUksR0FHcEIsSUFGQSxJQUFJQyxFQUFRQyxLQUVMRixJQUFtQkUsS0FBS1QsUUFDekJPLEVBQWlCRSxLQUFLVCxPQUN4QixXQUNFLElBQUlVLEVBQU1DLE9B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QyxHQUNMLElBQUk0QyxFQUFTNUcsS0FHVDZHLEdBRDJCLEVBQW5CeEYsVUFBVTlCLGFBQStCK0IsSUFIaEQsRUFBQSxFQUcyRSxJQUNsRG1FLFlBQzFCQSxPQUFvQyxJQUF0Qm9CLEdBQXVDQSxFQUV6RCxJQUFLN0csS0FBS3lHLHFCQUNSLE9BQU96RyxLQU1ULElBSEEsSUFBSThHLEVBQVcsR0FDWDlGLEVBQVEsRUFFTEEsRUFBUWhCLEtBQUt5RyxxQkFBcUJsSCxRQUFRLENBQy9DLElBQUl3SCxFQUF3Qi9HLEtBQUt5RyxxQkFBcUJ6RixHQUNsRGdHLEVBQWNELEVBQXNCTCxRQUNwQzdCLEVBQVlrQyxFQUFzQmpELE1BQ2xDZ0IsRUFBY2lDLEVBQXNCaEQsUUFDcENnQixFQUFXZ0MsRUFBc0IvQyxLQUUvQjBDLEdBQVdBLElBQVlNLEdBQWtCbEQsR0FBU0EsSUFBVWUsR0FBZ0JkLEdBQVdBLElBQVllLEdBQXlCLE1BQVJkLEdBQWdCQSxJQUFTZSxFQVVuSi9ELEtBVEVoQixLQUFLeUcscUJBQXFCdkIsT0FBT2xFLEVBQU8sR0FFcENnRyxJQUFrRCxJQUFuQ0YsRUFBU2hCLFFBQVFrQixJQUNsQ0YsRUFBU3JGLEtBQUt1RixJQWlCcEIsT0FSS3ZCLEdBQ0hxQixFQUFTL0YsUUFBUSxTQUFVMkYsR0FDekJBLEVBQVFsQyxJQUFJVixFQUFPQyxFQUFTQyxFQUFNNEMsRUFBUSxDQUN4Q25CLGFBQWEsTUFLWnpGLFFBTWIsU0FBU3NHLG1CQUNQLElBQUlsRixFQUF5QixFQUFuQkMsVUFBVTlCLGFBQStCK0IsSUFBakJELFVBQVUsR0FBbUJBLFVBQVUsR0FBSyxHQU05RSxPQUpLRCxFQUFJb0YsK0NBQ1BwRixFQUFNdEMsT0FBTzBDLGlCQUFpQkosRUFBS21GLHNDQUc5Qm5GIiwiZmlsZSI6ImV2ZW50ZnVsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH1cblxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2VcIik7IH1cblxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyKSA9PT0gXCJbb2JqZWN0IEFyZ3VtZW50c11cIikgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7IH1cblxuZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gfVxuXG4vKiBnbG9iYWwgZXZlbnRmdWwgKi9cbnZhciBldmVudGZ1bENvbGxlY3Rpb25Qcm9wZXJ0eURlc2NyaXB0b3JzID0ge1xuICBkZWZpbmVkQnlFdmVudGZ1bENvbGxlY3Rpb25Qcm9wZXJ0eURlc2NyaXB0b3JzOiB7XG4gICAgdmFsdWU6IHRydWVcbiAgfSxcbiAgZXZlbnRmdWxDb2xsZWN0aW9uRGF0YToge1xuICAgIHdyaXRhYmxlOiB0cnVlXG4gIH0sXG4gIGFkanVzdEV2ZW50ZnVsQ29sbGVjdGlvbjoge1xuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShzdGFydGluZ0xlbmd0aCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgd2hpbGUgKHN0YXJ0aW5nTGVuZ3RoICE9PSB0aGlzLmxlbmd0aCkge1xuICAgICAgICBpZiAoc3RhcnRpbmdMZW5ndGggPCB0aGlzLmxlbmd0aCkge1xuICAgICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gU3RyaW5nKHN0YXJ0aW5nTGVuZ3RoKTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywga2V5LCB7XG4gICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ldmVudGZ1bENvbGxlY3Rpb25EYXRhW2tleV0gIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLmV2ZW50ZnVsQ29sbGVjdGlvbkRhdGFba2V5XTtcbiAgICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRmdWxDb2xsZWN0aW9uRGF0YVtrZXldID0gdmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlZmluZWRCeUV2ZW50ZnVsRW1pdHRlclByb3BlcnR5RGVzY3JpcHRvcnMgJiYgdmFsdWUgIT09IG9sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignY2hhbmdlJywga2V5LCB2YWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJjaGFuZ2U6XCIuY29uY2F0KGtleSksIHZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ldmVudGZ1bENvbGxlY3Rpb25EYXRhW2tleV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc3RhcnRpbmdMZW5ndGgrKztcbiAgICAgICAgICB9KSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlbGV0ZSB0aGlzW1N0cmluZyhzdGFydGluZ0xlbmd0aCAtIDEpXTtcbiAgICAgICAgICBzdGFydGluZ0xlbmd0aC0tO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBsZW5ndGg6IHtcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIGlmICh0aGlzLmV2ZW50ZnVsQ29sbGVjdGlvbkRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRmdWxDb2xsZWN0aW9uRGF0YS5sZW5ndGg7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfSxcbiAgdG9BcnJheToge1xuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHtcbiAgICAgIGlmICghdGhpcy5ldmVudGZ1bENvbGxlY3Rpb25EYXRhKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cblxuICAgICAgdmFyIGFycmF5ID0gdGhpcy5ldmVudGZ1bENvbGxlY3Rpb25EYXRhLnNsaWNlKCk7XG4gICAgICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgaWYgKHZhbHVlLmRlZmluZWRCeUV2ZW50ZnVsRGljdGlvbmFyeVByb3BlcnR5RGVzY3JpcHRvcnMpIHtcbiAgICAgICAgICBhcnJheVtpbmRleF0gPSB2YWx1ZS50b0pTT04oKTtcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZS5kZWZpbmVkQnlFdmVudGZ1bENvbGxlY3Rpb25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7XG4gICAgICAgICAgYXJyYXlbaW5kZXhdID0gdmFsdWUudG9BcnJheSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhcnJheTtcbiAgICB9XG4gIH1cbn07XG5bJ2NvcHlXaXRoaW4nLCAnZmlsbCcsICdwb3AnLCAncHVzaCcsICdyZXZlcnNlJywgJ3NoaWZ0JywgJ3NvcnQnLCAnc3BsaWNlJywgJ3Vuc2hpZnQnXS5mb3JFYWNoKGZ1bmN0aW9uIChtZXRob2QpIHtcbiAgZXZlbnRmdWxDb2xsZWN0aW9uUHJvcGVydHlEZXNjcmlwdG9yc1ttZXRob2RdID0ge1xuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHtcbiAgICAgIHZhciBfQXJyYXkkcHJvdG90eXBlJG1ldGg7XG5cbiAgICAgIHZhciBzdGFydGluZ0xlbmd0aCA9IHRoaXMubGVuZ3RoO1xuXG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICAgIH1cblxuICAgICAgdmFyIHJldHVyblZhbHVlID0gKF9BcnJheSRwcm90b3R5cGUkbWV0aCA9IEFycmF5LnByb3RvdHlwZVttZXRob2RdKS5jYWxsLmFwcGx5KF9BcnJheSRwcm90b3R5cGUkbWV0aCwgW3RoaXMuZXZlbnRmdWxDb2xsZWN0aW9uRGF0YV0uY29uY2F0KGFyZ3MpKTtcblxuICAgICAgdGhpcy5hZGp1c3RFdmVudGZ1bENvbGxlY3Rpb24oc3RhcnRpbmdMZW5ndGgpO1xuXG4gICAgICBpZiAodGhpcy5kZWZpbmVkQnlFdmVudGZ1bEVtaXR0ZXJQcm9wZXJ0eURlc2NyaXB0b3JzKSB7XG4gICAgICAgIHRoaXMudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICB9XG4gIH07XG59KTtcblsnY29uY2F0JywgJ2luY2x1ZGVzJywgJ2luZGV4T2YnLCAnam9pbicsICdsYXN0SW5kZXhPZicsICdzbGljZScsICd0b1NvdXJjZScsICd0b1N0cmluZycsICd0b0xvY2FsZVN0cmluZycsICdlbnRyaWVzJywgJ2V2ZXJ5JywgJ2ZpbHRlcicsICdmaW5kJywgJ2ZpbmRJbmRleCcsICdmb3JFYWNoJywgJ2tleXMnLCAnbWFwJywgJ3JlZHVjZScsICdyZWR1Y2VSaWdodCcsICdzb21lJywgJ3ZhbHVlcyddLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZCkge1xuICBldmVudGZ1bENvbGxlY3Rpb25Qcm9wZXJ0eURlc2NyaXB0b3JzW21ldGhvZF0gPSB7XG4gICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkge1xuICAgICAgdmFyIF9BcnJheSRwcm90b3R5cGUkbWV0aDI7XG5cbiAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMiksIF9rZXkyID0gMDsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykge1xuICAgICAgICBhcmdzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAoX0FycmF5JHByb3RvdHlwZSRtZXRoMiA9IEFycmF5LnByb3RvdHlwZVttZXRob2RdKS5jYWxsLmFwcGx5KF9BcnJheSRwcm90b3R5cGUkbWV0aDIsIFt0aGlzLmV2ZW50ZnVsQ29sbGVjdGlvbkRhdGFdLmNvbmNhdChhcmdzKSk7XG4gICAgfVxuICB9O1xufSk7XG4vKiBleHBvcnRlZCBldmVudGZ1bENvbGxlY3Rpb24gKi9cblxuZnVuY3Rpb24gZXZlbnRmdWxDb2xsZWN0aW9uKCkge1xuICB2YXIgX29iajtcblxuICB2YXIgb2JqID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgdmFyIHZhbHVlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbXTtcblxuICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgdmFsdWUgPSBvYmo7XG4gICAgb2JqID0ge307XG4gIH1cblxuICBvYmogPSBvYmogPSBldmVudGZ1bChvYmopO1xuXG4gIGlmICghb2JqLmRlZmluZWRCeUV2ZW50ZnVsQ29sbGVjdGlvblByb3BlcnR5RGVzY3JpcHRvcnMpIHtcbiAgICBvYmogPSBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhvYmosIGV2ZW50ZnVsQ29sbGVjdGlvblByb3BlcnR5RGVzY3JpcHRvcnMpO1xuICB9XG5cbiAgKF9vYmogPSBvYmopLnB1c2guYXBwbHkoX29iaiwgX3RvQ29uc3VtYWJsZUFycmF5KHZhbHVlKSk7XG5cbiAgcmV0dXJuIG9iajtcbn1cbi8qIGdsb2JhbCBldmVudGZ1bCAqL1xuXG5cbnZhciBldmVudGZ1bERpY3Rpb25hcnlQcm9wZXJ0eURlc2NyaXB0b3JzID0ge1xuICBkZWZpbmVkQnlFdmVudGZ1bERpY3Rpb25hcnlQcm9wZXJ0eURlc2NyaXB0b3JzOiB7XG4gICAgdmFsdWU6IHRydWVcbiAgfSxcbiAgZXZlbnRmdWxEaWN0aW9uYXJ5RGF0YToge1xuICAgIHdyaXRhYmxlOiB0cnVlXG4gIH0sXG4gIG9ic2VydmVQcm9wZXJ0eToge1xuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShuYW1lKSB7XG4gICAgICB2YXIgX3ZhbHVlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB0aGlzW25hbWVdO1xuXG4gICAgICB2YXIgX3JlZiA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge30sXG4gICAgICAgICAgX3JlZiRzZXR0ZXIgPSBfcmVmLnNldHRlcixcbiAgICAgICAgICBzZXR0ZXIgPSBfcmVmJHNldHRlciA9PT0gdm9pZCAwID8gZnVuY3Rpb24gKHZhbHVlLCBzZXR0ZXJDYmspIHtcbiAgICAgICAgcmV0dXJuIHNldHRlckNiaygpO1xuICAgICAgfSA6IF9yZWYkc2V0dGVyLFxuICAgICAgICAgIF9yZWYkZ2V0dGVyID0gX3JlZi5nZXR0ZXIsXG4gICAgICAgICAgZ2V0dGVyID0gX3JlZiRnZXR0ZXIgPT09IHZvaWQgMCA/IGZ1bmN0aW9uIChnZXR0ZXJDYmspIHtcbiAgICAgICAgcmV0dXJuIGdldHRlckNiaygpO1xuICAgICAgfSA6IF9yZWYkZ2V0dGVyO1xuXG4gICAgICBpZiAoIXRoaXMuZXZlbnRmdWxEaWN0aW9uYXJ5RGF0YSkge1xuICAgICAgICB0aGlzLmV2ZW50ZnVsRGljdGlvbmFyeURhdGEgPSB7fTtcbiAgICAgIH1cblxuICAgICAgdmFyIHByb3BlcnR5RGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGhpcywgbmFtZSk7XG5cbiAgICAgIGlmICghcHJvcGVydHlEZXNjcmlwdG9yIHx8ICFwcm9wZXJ0eURlc2NyaXB0b3IuZ2V0ICYmICFwcm9wZXJ0eURlc2NyaXB0b3Iuc2V0KSB7XG4gICAgICAgIGlmIChfdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRoaXMuZXZlbnRmdWxEaWN0aW9uYXJ5RGF0YVtuYW1lXSA9IF92YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlbGV0ZSB0aGlzW25hbWVdO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgbmFtZSwge1xuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKHRoaXMuZXZlbnRmdWxEaWN0aW9uYXJ5RGF0YVtuYW1lXSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0gdGhpcy5ldmVudGZ1bERpY3Rpb25hcnlEYXRhW25hbWVdO1xuICAgICAgICAgICAgICBzZXR0ZXIuY2FsbCh0aGlzLCB2YWx1ZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMi5ldmVudGZ1bERpY3Rpb25hcnlEYXRhW25hbWVdID0gdmFsdWU7XG5cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLmRlZmluZWRCeUV2ZW50ZnVsRW1pdHRlclByb3BlcnR5RGVzY3JpcHRvcnMgJiYgdmFsdWUgIT09IG9sZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICBfdGhpczIudHJpZ2dlcignY2hhbmdlJywgbmFtZSwgdmFsdWUsIG9sZFZhbHVlKTtcblxuICAgICAgICAgICAgICAgICAgX3RoaXMyLnRyaWdnZXIoXCJjaGFuZ2U6XCIuY29uY2F0KG5hbWUpLCB2YWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gZ2V0dGVyLmNhbGwodGhpcywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLmV2ZW50ZnVsRGljdGlvbmFyeURhdGFbbmFtZV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sXG4gIHVub2JzZXJ2ZVByb3BlcnR5OiB7XG4gICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKG5hbWUpIHtcbiAgICAgIGlmICh0aGlzLmV2ZW50ZnVsRGljdGlvbmFyeURhdGEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIHZhciBwcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRoaXMsIG5hbWUpO1xuXG4gICAgICBpZiAocHJvcGVydHlEZXNjcmlwdG9yICYmIChwcm9wZXJ0eURlc2NyaXB0b3IuZ2V0IHx8IHByb3BlcnR5RGVzY3JpcHRvci5zZXQpKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZXZlbnRmdWxEaWN0aW9uYXJ5RGF0YVtuYW1lXTtcbiAgICAgICAgZGVsZXRlIHRoaXMuZXZlbnRmdWxEaWN0aW9uYXJ5RGF0YVtuYW1lXTtcbiAgICAgICAgZGVsZXRlIHRoaXNbbmFtZV07XG5cbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB0aGlzW25hbWVdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9LFxuICB0b0pTT046IHtcbiAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7XG4gICAgICB2YXIganNvbiA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZXZlbnRmdWxEaWN0aW9uYXJ5RGF0YSk7XG5cbiAgICAgIGZvciAodmFyIGtleSBpbiBqc29uKSB7XG4gICAgICAgIGlmIChqc29uW2tleV0uZGVmaW5lZEJ5RXZlbnRmdWxEaWN0aW9uYXJ5UHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgICAgICAgIGpzb25ba2V5XSA9IGpzb25ba2V5XS50b0pTT04oKTtcbiAgICAgICAgfSBlbHNlIGlmIChqc29uW2tleV0uZGVmaW5lZEJ5RXZlbnRmdWxDb2xsZWN0aW9uUHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgICAgICAgIGpzb25ba2V5XSA9IGpzb25ba2V5XS50b0FycmF5KCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGpzb247XG4gICAgfVxuICB9XG59O1xuLyogZXhwb3J0ZWQgZXZlbnRmdWxEaWN0aW9uYXJ5ICovXG5cbmZ1bmN0aW9uIGV2ZW50ZnVsRGljdGlvbmFyeSgpIHtcbiAgdmFyIG9iaiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gIG9iaiA9IGV2ZW50ZnVsKG9iaik7XG5cbiAgaWYgKCFvYmouZGVmaW5lZEJ5RXZlbnRmdWxEaWN0aW9uYXJ5UHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgIG9iaiA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG9iaiwgZXZlbnRmdWxEaWN0aW9uYXJ5UHJvcGVydHlEZXNjcmlwdG9ycyk7XG4gIH1cblxuICBPYmplY3Qua2V5cyhvYmopLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgb2JqLm9ic2VydmVQcm9wZXJ0eShwcm9wZXJ0eSk7XG4gIH0pO1xuICByZXR1cm4gb2JqO1xufVxuLyogZ2xvYmFsIGV2ZW50ZnVsRW1pdHRlclByb3BlcnR5RGVzY3JpcHRvcnMgZXZlbnRmdWwgKi9cblxuXG52YXIgZXZlbnRmdWxEb21Qcm9wZXJ0eURlc2NyaXB0b3JzID0ge1xuICBkZWZpbmVkQnlFdmVudGZ1bERvbVByb3BlcnR5RGVzY3JpcHRvcnM6IHtcbiAgICB2YWx1ZTogdHJ1ZVxuICB9LFxuICBldmVudGZ1bERvbURhdGE6IHtcbiAgICB3cml0YWJsZTogdHJ1ZVxuICB9LFxuICBvbjoge1xuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShldmVudCwgaGFuZGxlciwgb25jZSwgb2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICB2YXIgX3JlZjIgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IHt9LFxuICAgICAgICAgIF9yZWYyJGZyb21PYnNlcnZlciA9IF9yZWYyLmZyb21PYnNlcnZlcixcbiAgICAgICAgICBmcm9tT2JzZXJ2ZXIgPSBfcmVmMiRmcm9tT2JzZXJ2ZXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjIkZnJvbU9ic2VydmVyO1xuXG4gICAgICBpZiAoIXRoaXMuZXZlbnRmdWxEb21EYXRhKSB7XG4gICAgICAgIHRoaXMuZXZlbnRmdWxEb21EYXRhID0ge307XG4gICAgICB9XG5cbiAgICAgIHZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uIGxpc3RlbmVyKCkge1xuICAgICAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjMpLCBfa2V5MyA9IDA7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHtcbiAgICAgICAgICBhcmdzW19rZXkzXSA9IGFyZ3VtZW50c1tfa2V5M107XG4gICAgICAgIH1cblxuICAgICAgICBoYW5kbGVyLmNhbGwuYXBwbHkoaGFuZGxlciwgW190aGlzNF0uY29uY2F0KGFyZ3MpKTtcblxuICAgICAgICBpZiAob25jZSkge1xuICAgICAgICAgIF90aGlzNC5vZmYoZXZlbnQsIGhhbmRsZXIsIG9uY2UsIG9ic2VydmVyKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKG5hbWUsIGxpc3RlbmVyKTtcbiAgICAgIHRoaXMuZXZlbnRmdWxEb21EYXRhLnB1c2goe1xuICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgIGhhbmRsZXI6IGhhbmRsZXIsXG4gICAgICAgIG9uY2U6IG9uY2UsXG4gICAgICAgIG9ic2VydmVyOiBvYnNlcnZlcixcbiAgICAgICAgbGlzdGVuZXI6IGxpc3RlbmVyXG4gICAgICB9KTtcblxuICAgICAgaWYgKHRoaXMuZGVmaW5lZEJ5RXZlbnRmdWxFbWl0dGVyUHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgICAgICByZXR1cm4gZXZlbnRmdWxFbWl0dGVyUHJvcGVydHlEZXNjcmlwdG9ycy5vbi52YWx1ZS5jYWxsKHRoaXMsIGV2ZW50LCBoYW5kbGVyLCBvbmNlLCBvYnNlcnZlciwge1xuICAgICAgICAgIGZyb21PYnNlcnZlcjogZnJvbU9ic2VydmVyXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sXG4gIG9mZjoge1xuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShldmVudCwgaGFuZGxlciwgb25jZSwgb2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBfcmVmMyA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDoge30sXG4gICAgICAgICAgX3JlZjMkZnJvbU9ic2VydmVyID0gX3JlZjMuZnJvbU9ic2VydmVyLFxuICAgICAgICAgIGZyb21PYnNlcnZlciA9IF9yZWYzJGZyb21PYnNlcnZlciA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmMyRmcm9tT2JzZXJ2ZXI7XG5cbiAgICAgIGlmICh0aGlzLmV2ZW50ZnVsRG9tRGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgdmFyIGluZGV4ID0gMDtcblxuICAgICAgd2hpbGUgKGluZGV4IDwgdGhpcy5ldmVudGZ1bERvbURhdGEubGVuZ3RoKSB7XG4gICAgICAgIHZhciBfdGhpcyRldmVudGZ1bERvbURhdGEgPSB0aGlzLmV2ZW50ZnVsRG9tRGF0YVtpbmRleF0sXG4gICAgICAgICAgICBkYXRhRXZlbnQgPSBfdGhpcyRldmVudGZ1bERvbURhdGEuZXZlbnQsXG4gICAgICAgICAgICBkYXRhSGFuZGxlciA9IF90aGlzJGV2ZW50ZnVsRG9tRGF0YS5oYW5kbGVyLFxuICAgICAgICAgICAgZGF0YU9uY2UgPSBfdGhpcyRldmVudGZ1bERvbURhdGEub25jZSxcbiAgICAgICAgICAgIGRhdGFPYnNlcnZlciA9IF90aGlzJGV2ZW50ZnVsRG9tRGF0YS5vYnNlcnZlcixcbiAgICAgICAgICAgIGRhdGFMaXN0ZW5lciA9IF90aGlzJGV2ZW50ZnVsRG9tRGF0YS5saXN0ZW5lcjtcblxuICAgICAgICBpZiAoKCFldmVudCB8fCBldmVudCA9PT0gZGF0YUV2ZW50KSAmJiAoIWhhbmRsZXIgfHwgaGFuZGxlciA9PT0gZGF0YUhhbmRsZXIpICYmIChvbmNlID09IG51bGwgfHwgb25jZSA9PT0gZGF0YU9uY2UpICYmICghb2JzZXJ2ZXIgfHwgb2JzZXJ2ZXIgPT09IGRhdGFPYnNlcnZlcikpIHtcbiAgICAgICAgICB0aGlzLmV2ZW50ZnVsRG9tRGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBkYXRhTGlzdGVuZXIpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5kZXgrKztcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuZGVmaW5lZEJ5RXZlbnRmdWxFbWl0dGVyUHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgICAgICByZXR1cm4gZXZlbnRmdWxFbWl0dGVyUHJvcGVydHlEZXNjcmlwdG9ycy5vZmYudmFsdWUuY2FsbCh0aGlzLCBldmVudCwgaGFuZGxlciwgb25jZSwgb2JzZXJ2ZXIsIHtcbiAgICAgICAgICBmcm9tT2JzZXJ2ZXI6IGZyb21PYnNlcnZlclxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9XG59O1xuLyogZXhwb3J0ZWQgZXZlbnRmdWxEb20gKi9cblxuZnVuY3Rpb24gZXZlbnRmdWxEb20oKSB7XG4gIHZhciBvYmogPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICBvYmogPSBldmVudGZ1bChvYmopO1xuXG4gIGlmICghb2JqLmRlZmluZWRCeUV2ZW50ZnVsRG9tUHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgIG9iaiA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG9iaiwgZXZlbnRmdWxEb21Qcm9wZXJ0eURlc2NyaXB0b3JzKTtcbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG4vKiBleHBvcnRlZCBldmVudGZ1bEVtaXR0ZXJQcm9wZXJ0eURlc2NyaXB0b3JzICovXG5cblxudmFyIGV2ZW50ZnVsRW1pdHRlclByb3BlcnR5RGVzY3JpcHRvcnMgPSB7XG4gIGRlZmluZWRCeUV2ZW50ZnVsRW1pdHRlclByb3BlcnR5RGVzY3JpcHRvcnM6IHtcbiAgICB2YWx1ZTogdHJ1ZVxuICB9LFxuICBldmVudGZ1bEVtaXR0ZXJFbmFibGVkOiB7XG4gICAgd3JpdGFibGU6IHRydWUsXG4gICAgdmFsdWU6IHRydWVcbiAgfSxcbiAgZXZlbnRmdWxFbWl0dGVyRGF0YToge1xuICAgIHdyaXRhYmxlOiB0cnVlXG4gIH0sXG4gIG9uOiB7XG4gICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGV2ZW50LCBoYW5kbGVyLCBvbmNlLCBvYnNlcnZlcikge1xuICAgICAgdmFyIF9yZWY0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB7fSxcbiAgICAgICAgICBfcmVmNCRmcm9tT2JzZXJ2ZXIgPSBfcmVmNC5mcm9tT2JzZXJ2ZXIsXG4gICAgICAgICAgZnJvbU9ic2VydmVyID0gX3JlZjQkZnJvbU9ic2VydmVyID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWY0JGZyb21PYnNlcnZlcjtcblxuICAgICAgaWYgKCF0aGlzLmV2ZW50ZnVsRW1pdHRlckRhdGEpIHtcbiAgICAgICAgdGhpcy5ldmVudGZ1bEVtaXR0ZXJEYXRhID0gW107XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZXZlbnRmdWxFbWl0dGVyRGF0YS5wdXNoKHtcbiAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICBoYW5kbGVyOiBoYW5kbGVyLFxuICAgICAgICBvbmNlOiBvbmNlLFxuICAgICAgICBvYnNlcnZlcjogb2JzZXJ2ZXJcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWZyb21PYnNlcnZlciAmJiBvYnNlcnZlcikge1xuICAgICAgICBvYnNlcnZlci5saXN0ZW5Ubyh0aGlzLCBldmVudCwgaGFuZGxlciwgb25jZSwge1xuICAgICAgICAgIGZyb21FbWl0dGVyOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sXG4gIG9mZjoge1xuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShldmVudCwgaGFuZGxlciwgb25jZSwgb2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICB2YXIgX3JlZjUgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IHt9LFxuICAgICAgICAgIF9yZWY1JGZyb21PYnNlcnZlciA9IF9yZWY1LmZyb21PYnNlcnZlcixcbiAgICAgICAgICBmcm9tT2JzZXJ2ZXIgPSBfcmVmNSRmcm9tT2JzZXJ2ZXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjUkZnJvbU9ic2VydmVyO1xuXG4gICAgICBpZiAoIXRoaXMuZXZlbnRmdWxFbWl0dGVyRGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgdmFyIG9ic2VydmVycyA9IFtdO1xuICAgICAgdmFyIGluZGV4ID0gMDtcblxuICAgICAgd2hpbGUgKGluZGV4IDwgdGhpcy5ldmVudGZ1bEVtaXR0ZXJEYXRhLmxlbmd0aCkge1xuICAgICAgICB2YXIgX3RoaXMkZXZlbnRmdWxFbWl0dGVyID0gdGhpcy5ldmVudGZ1bEVtaXR0ZXJEYXRhW2luZGV4XSxcbiAgICAgICAgICAgIGRhdGFFdmVudCA9IF90aGlzJGV2ZW50ZnVsRW1pdHRlci5ldmVudCxcbiAgICAgICAgICAgIGRhdGFIYW5kbGVyID0gX3RoaXMkZXZlbnRmdWxFbWl0dGVyLmhhbmRsZXIsXG4gICAgICAgICAgICBkYXRhT25jZSA9IF90aGlzJGV2ZW50ZnVsRW1pdHRlci5vbmNlLFxuICAgICAgICAgICAgZGF0YU9ic2VydmVyID0gX3RoaXMkZXZlbnRmdWxFbWl0dGVyLm9ic2VydmVyO1xuXG4gICAgICAgIGlmICgoIWV2ZW50IHx8IGV2ZW50ID09PSBkYXRhRXZlbnQpICYmICghaGFuZGxlciB8fCBoYW5kbGVyID09PSBkYXRhSGFuZGxlcikgJiYgKG9uY2UgPT0gbnVsbCB8fCBvbmNlID09PSBkYXRhT25jZSkgJiYgKCFvYnNlcnZlciB8fCBvYnNlcnZlciA9PT0gZGF0YU9ic2VydmVyKSkge1xuICAgICAgICAgIHRoaXMuZXZlbnRmdWxFbWl0dGVyRGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICAgICAgaWYgKGRhdGFPYnNlcnZlciAmJiBvYnNlcnZlcnMuaW5kZXhPZihkYXRhT2JzZXJ2ZXIpID09PSAtMSkge1xuICAgICAgICAgICAgb2JzZXJ2ZXJzLnB1c2goZGF0YU9ic2VydmVyKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGluZGV4Kys7XG4gICAgICB9XG5cbiAgICAgIGlmICghZnJvbU9ic2VydmVyKSB7XG4gICAgICAgIG9ic2VydmVycy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhT2JzZXJ2ZXIpIHtcbiAgICAgICAgICBkYXRhT2JzZXJ2ZXIuc3RvcExpc3RlbmluZyhfdGhpczUsIGV2ZW50LCBoYW5kbGVyLCBvbmNlLCB7XG4gICAgICAgICAgICBmcm9tRW1pdHRlcjogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9LFxuICB0cmlnZ2VyOiB7XG4gICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGV2ZW50KSB7XG4gICAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgICAgZm9yICh2YXIgX2xlbjQgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW40ID4gMSA/IF9sZW40IC0gMSA6IDApLCBfa2V5NCA9IDE7IF9rZXk0IDwgX2xlbjQ7IF9rZXk0KyspIHtcbiAgICAgICAgYXJnc1tfa2V5NCAtIDFdID0gYXJndW1lbnRzW19rZXk0XTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF0aGlzLmV2ZW50ZnVsRW1pdHRlckRhdGEgfHwgIXRoaXMuZXZlbnRmdWxFbWl0dGVyRW5hYmxlZCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgdGhpcy5ldmVudGZ1bEVtaXR0ZXJEYXRhLmZvckVhY2goZnVuY3Rpb24gKF9yZWY2KSB7XG4gICAgICAgIHZhciBkYXRhRXZlbnQgPSBfcmVmNi5ldmVudCxcbiAgICAgICAgICAgIGhhbmRsZXIgPSBfcmVmNi5oYW5kbGVyLFxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSBfcmVmNi5vYnNlcnZlcjtcblxuICAgICAgICBpZiAoZXZlbnQgPT09IGRhdGFFdmVudCkge1xuICAgICAgICAgIHZhciBjb250ZXh0ID0gb2JzZXJ2ZXIgfHwgX3RoaXM2O1xuICAgICAgICAgIGhhbmRsZXIuY2FsbC5hcHBseShoYW5kbGVyLCBbY29udGV4dF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICB0aGlzLm9mZihldmVudCwgbnVsbCwgdHJ1ZSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH1cbn07XG4vKiBleHBvcnRlZCBldmVudGZ1bEVtaXR0ZXIgKi9cblxuZnVuY3Rpb24gZXZlbnRmdWxFbWl0dGVyKCkge1xuICB2YXIgb2JqID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICBpZiAoIW9iai5kZWZpbmVkQnlFdmVudGZ1bEVtaXR0ZXJQcm9wZXJ0eURlc2NyaXB0b3JzKSB7XG4gICAgb2JqID0gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMob2JqLCBldmVudGZ1bEVtaXR0ZXJQcm9wZXJ0eURlc2NyaXB0b3JzKTtcbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG4vKiBnbG9iYWwgZXZlbnRmdWxPYnNlcnZlciBldmVudGZ1bEVtaXR0ZXIgKi9cblxuLyogZXhwb3J0ZWQgZXZlbnRmdWwgKi9cblxuXG5mdW5jdGlvbiBldmVudGZ1bChvYmopIHtcbiAgcmV0dXJuIGV2ZW50ZnVsT2JzZXJ2ZXIoZXZlbnRmdWxFbWl0dGVyKG9iaikpO1xufVxuXG52YXIgZXZlbnRmdWxPYnNlcnZlclByb3BlcnR5RGVzY3JpcHRvcnMgPSB7XG4gIGRlZmluZWRCeUV2ZW50ZnVsT2JzZXJ2ZXJQcm9wZXJ0eURlc2NyaXB0b3JzOiB7XG4gICAgdmFsdWU6IHRydWVcbiAgfSxcbiAgZXZlbnRmdWxPYnNlcnZlckRhdGE6IHtcbiAgICB3cml0YWJsZTogdHJ1ZVxuICB9LFxuICBsaXN0ZW5Ubzoge1xuICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShlbWl0dGVyLCBldmVudCwgaGFuZGxlciwgb25jZSkge1xuICAgICAgdmFyIF9yZWY3ID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB7fSxcbiAgICAgICAgICBfcmVmNyRmcm9tRW1pdHRlciA9IF9yZWY3LmZyb21FbWl0dGVyLFxuICAgICAgICAgIGZyb21FbWl0dGVyID0gX3JlZjckZnJvbUVtaXR0ZXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjckZnJvbUVtaXR0ZXI7XG5cbiAgICAgIGlmICghZnJvbUVtaXR0ZXIgJiYgZW1pdHRlcikge1xuICAgICAgICBlbWl0dGVyLm9uKGV2ZW50LCBoYW5kbGVyLCBvbmNlLCB0aGlzLCB7XG4gICAgICAgICAgZnJvbU9ic2VydmVyOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMuZXZlbnRmdWxPYnNlcnZlckRhdGEpIHtcbiAgICAgICAgdGhpcy5ldmVudGZ1bE9ic2VydmVyRGF0YSA9IFtdO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmV2ZW50ZnVsT2JzZXJ2ZXJEYXRhLnB1c2goe1xuICAgICAgICBlbWl0dGVyOiBlbWl0dGVyLFxuICAgICAgICBldmVudDogZXZlbnQsXG4gICAgICAgIGhhbmRsZXI6IGhhbmRsZXIsXG4gICAgICAgIG9uY2U6IG9uY2VcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9LFxuICBzdG9wTGlzdGVuaW5nOiB7XG4gICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlKGVtaXR0ZXIsIGV2ZW50LCBoYW5kbGVyLCBvbmNlKSB7XG4gICAgICB2YXIgX3RoaXM3ID0gdGhpcztcblxuICAgICAgdmFyIF9yZWY4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB7fSxcbiAgICAgICAgICBfcmVmOCRmcm9tRW1pdHRlciA9IF9yZWY4LmZyb21FbWl0dGVyLFxuICAgICAgICAgIGZyb21FbWl0dGVyID0gX3JlZjgkZnJvbUVtaXR0ZXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjgkZnJvbUVtaXR0ZXI7XG5cbiAgICAgIGlmICghdGhpcy5ldmVudGZ1bE9ic2VydmVyRGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgdmFyIGVtaXR0ZXJzID0gW107XG4gICAgICB2YXIgaW5kZXggPSAwO1xuXG4gICAgICB3aGlsZSAoaW5kZXggPCB0aGlzLmV2ZW50ZnVsT2JzZXJ2ZXJEYXRhLmxlbmd0aCkge1xuICAgICAgICB2YXIgX3RoaXMkZXZlbnRmdWxPYnNlcnZlID0gdGhpcy5ldmVudGZ1bE9ic2VydmVyRGF0YVtpbmRleF0sXG4gICAgICAgICAgICBkYXRhRW1pdHRlciA9IF90aGlzJGV2ZW50ZnVsT2JzZXJ2ZS5lbWl0dGVyLFxuICAgICAgICAgICAgZGF0YUV2ZW50ID0gX3RoaXMkZXZlbnRmdWxPYnNlcnZlLmV2ZW50LFxuICAgICAgICAgICAgZGF0YUhhbmRsZXIgPSBfdGhpcyRldmVudGZ1bE9ic2VydmUuaGFuZGxlcixcbiAgICAgICAgICAgIGRhdGFPbmNlID0gX3RoaXMkZXZlbnRmdWxPYnNlcnZlLm9uY2U7XG5cbiAgICAgICAgaWYgKCghZW1pdHRlciB8fCBlbWl0dGVyID09PSBkYXRhRW1pdHRlcikgJiYgKCFldmVudCB8fCBldmVudCA9PT0gZGF0YUV2ZW50KSAmJiAoIWhhbmRsZXIgfHwgaGFuZGxlciA9PT0gZGF0YUhhbmRsZXIpICYmIChvbmNlID09IG51bGwgfHwgb25jZSA9PT0gZGF0YU9uY2UpKSB7XG4gICAgICAgICAgdGhpcy5ldmVudGZ1bE9ic2VydmVyRGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICAgICAgaWYgKGRhdGFFbWl0dGVyICYmIGVtaXR0ZXJzLmluZGV4T2YoZGF0YUVtaXR0ZXIpID09PSAtMSkge1xuICAgICAgICAgICAgZW1pdHRlcnMucHVzaChkYXRhRW1pdHRlcik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpbmRleCsrO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWZyb21FbWl0dGVyKSB7XG4gICAgICAgIGVtaXR0ZXJzLmZvckVhY2goZnVuY3Rpb24gKGVtaXR0ZXIpIHtcbiAgICAgICAgICBlbWl0dGVyLm9mZihldmVudCwgaGFuZGxlciwgb25jZSwgX3RoaXM3LCB7XG4gICAgICAgICAgICBmcm9tRW1pdHRlcjogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9XG59O1xuLyogZXhwb3J0ZWQgZXZlbnRmdWxPYnNlcnZlciAqL1xuXG5mdW5jdGlvbiBldmVudGZ1bE9ic2VydmVyKCkge1xuICB2YXIgb2JqID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICBpZiAoIW9iai5kZWZpbmVkQnlFdmVudGZ1bE9ic2VydmVyUHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgIG9iaiA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG9iaiwgZXZlbnRmdWxPYnNlcnZlclByb3BlcnR5RGVzY3JpcHRvcnMpO1xuICB9XG5cbiAgcmV0dXJuIG9iajtcbn0iXX0=
